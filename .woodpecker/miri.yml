# SPDX-FileCopyrightText: 2023 Konrad Borowski <konrad@borowski.pw>
#
# SPDX-License-Identifier: MIT OR Apache-2.0

when:
  - event: pull_request
  - event: push
    branch:
       - master

steps:
  miri:
    image: instrumentisto/rust:nightly-2023-09-23@sha256:02f1c90678bf5b0d1463b4f2c53ccb2c91d77b2ef2ab63ecde361bce5bfea101
    environment:
      - CARGO_TERM_COLOR=always
    commands:
      - rustup component add miri
      - cargo miri test --all-features --locked --verbose
